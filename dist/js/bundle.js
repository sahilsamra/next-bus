const form=document.querySelector("form"),input=form.querySelector("input"),apiKey="Ehg5Nso4pNe0kGRIfPW",streetContainer=document.querySelector(".streets"),tableContainer=document.querySelector("tbody");function getStreetName(e){return fetch(`https://api.winnipegtransit.com/v3/streets.json?api-key=${apiKey}&name=${e}&usage=long`).then(e=>{if(e.ok)return e.json();throw new Error("There is a problem in street name (;T__T:)")}).then(e=>e.streets)}function buildStreetList(e){let t="";streetContainer.innerHTML="",getStreetName(e).then(e=>{0!==e.length?e.forEach(e=>{t+=`<a href="#" data-street-key="${e.key}">${e.name}</a>`}):t="No Streets found",streetContainer.insertAdjacentHTML("beforeend",t)})}function buildStreetNameHeader(e){const t=document.querySelector("#street-name");t.textContent="",t.textContent=`Displaying results for ${e}`}function buildSchedualTable(e){let n="";tableContainer.innerHTML="",getScheduleArray(e).then(e=>{for(var t of e)for(var r of t["route-schedules"])n+=` <tr>
                      <td>${t.stop.street.name}</td>
                      <td>${t.stop["cross-street"].name}</td>
                      <td>${t.stop.direction}</td>
                      <td>${r.route.number}</td>
                      <td>${timeFormatter(r["scheduled-stops"][0].times.departure.estimated)}</td>
                    </tr>`;tableContainer.insertAdjacentHTML("beforeend",n)})}function getScheduleArray(e){return gstStopNamesInStreet(e).then(e=>{const t=[];var r;for(r of e.map(e=>e.key))t.push(fetch(`https://api.winnipegtransit.com/v3/stops/${r}/schedule.json?api-key=${apiKey}&max-results-per-route=2`).then(e=>{if(e.ok)return e.json();throw new Error("There is a problem in stop names (;T__T:)")}).then(e=>e["stop-schedule"]));return Promise.all(t)})}function gstStopNamesInStreet(e){return fetch(`https://api.winnipegtransit.com/v3/stops.json?street=${e}&api-key=${apiKey}`).then(e=>{if(e.ok)return e.json();throw new Error("There is a problem in stop names (;T__T:)")}).then(e=>e.stops)}function timeFormatter(e){const t=new Date(e);return t.toLocaleTimeString("en-US",{timeZone:"Canada/Central",hour12:!0,hour:"numeric",minute:"numeric"})}form.addEventListener("keypress",function(e){13===e.keyCode&&(e.preventDefault(),buildStreetList(input.value))}),streetContainer.addEventListener("click",function(e){"A"===e.target.tagName&&(buildStreetNameHeader(e.target.textContent),buildSchedualTable(e.target.dataset.streetKey))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJmb3JtIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaW5wdXQiLCJhcGlLZXkiLCJzdHJlZXRDb250YWluZXIiLCJ0YWJsZUNvbnRhaW5lciIsImdldFN0cmVldE5hbWUiLCJpbnB1dFN0TmFtZSIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwib2siLCJqc29uIiwiRXJyb3IiLCJzdHJlZXRzIiwiYnVpbGRTdHJlZXRMaXN0IiwiaHRtbCIsImlubmVySFRNTCIsInN0cmVldEFycmF5IiwibGVuZ3RoIiwiZm9yRWFjaCIsImVsZSIsImtleSIsIm5hbWUiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJidWlsZFN0cmVldE5hbWVIZWFkZXIiLCJzdHJlZXROYW1lIiwic3RyZWV0TmFtZUVsZSIsInRleHRDb250ZW50IiwiYnVpbGRTY2hlZHVhbFRhYmxlIiwic3RyZWV0S2V5IiwiZ2V0U2NoZWR1bGVBcnJheSIsInNjaGVkdWxlIiwic2NoZWR1bGVBcnJheSIsInJvdXRlU2NoZWR1bGUiLCJzdG9wIiwic3RyZWV0IiwiZGlyZWN0aW9uIiwicm91dGUiLCJudW1iZXIiLCJ0aW1lRm9ybWF0dGVyIiwidGltZXMiLCJkZXBhcnR1cmUiLCJlc3RpbWF0ZWQiLCJnc3RTdG9wTmFtZXNJblN0cmVldCIsImpzb25Qcm9taXNlIiwic3RvcEtleSIsInN0b3BBcnJheSIsIm1hcCIsInB1c2giLCJQcm9taXNlIiwiYWxsIiwic3RvcHMiLCJ0aW1lU3RyaW5nIiwidGltZSIsIkRhdGUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJ0aW1lWm9uZSIsImhvdXIxMiIsImhvdXIiLCJtaW51dGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsInRhcmdldCIsInRhZ05hbWUiLCJkYXRhc2V0Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFBQSxLQUFBQyxTQUFBQyxjQUFBLFFBQ0FDLE1BQUFILEtBQUFFLGNBQUEsU0FDQUUsT0FBQSxzQkFDQUMsZ0JBQUFKLFNBQUFDLGNBQUEsWUFDQUksZUFBQUwsU0FBQUMsY0FBQSxTQWdCQSxTQUFBSyxjQUFBQyxHQUNBLE9BQUFDLGlFQUNBTCxlQUFBSSxnQkFFQUUsS0FBQSxJQUNBLEdBQUFDLEVBQUFDLEdBQ0EsT0FBQUQsRUFBQUUsT0FFQSxNQUFBLElBQUFDLE1BQUEsZ0RBR0FKLEtBQUEsR0FBQUcsRUFBQUUsU0FHQSxTQUFBQyxnQkFBQVIsR0FDQSxJQUFBUyxFQUFBLEdBQ0FaLGdCQUFBYSxVQUFBLEdBRUFYLGNBQUFDLEdBQUFFLEtBQUEsSUFDQSxJQUFBUyxFQUFBQyxPQUNBRCxFQUFBRSxRQUFBLElBQ0FKLG1DQUFBSyxFQUFBQyxRQUFBRCxFQUFBRSxhQUdBUCxFQUFBLG1CQUdBWixnQkFBQW9CLG1CQUFBLFlBQUFSLEtBSUEsU0FBQVMsc0JBQUFDLEdBQ0EsTUFBQUMsRUFBQTNCLFNBQUFDLGNBQUEsZ0JBQ0EwQixFQUFBQyxZQUFBLEdBQ0FELEVBQUFDLHNDQUFBRixJQUdBLFNBQUFHLG1CQUFBQyxHQUNBLElBQUFkLEVBQUEsR0FDQVgsZUFBQVksVUFBQSxHQUVBYyxpQkFBQUQsR0FBQXJCLEtBQUEsSUFDQSxJQUFBLElBQUF1QixLQUFBQyxFQUNBLElBQUEsSUFBQUMsS0FBQUYsRUFBQSxtQkFDQWhCOzRCQUNBZ0IsRUFBQUcsS0FBQUMsT0FBQWI7NEJBQ0FTLEVBQUFHLEtBQUEsZ0JBQUFaOzRCQUNBUyxFQUFBRyxLQUFBRTs0QkFDQUgsRUFBQUksTUFBQUM7NEJBQ0FDLGNBQ0FOLEVBQUEsbUJBQUEsR0FBQU8sTUFBQUMsVUFDQUM7MkJBTUF0QyxlQUFBbUIsbUJBQUEsWUFBQVIsS0FJQSxTQUFBZSxpQkFBQUQsR0FDQSxPQUFBYyxxQkFBQWQsR0FBQXJCLEtBQUEsSUFDQSxNQUFBb0MsRUFBQSxHQUNBLElBRUFDLEVBQUEsSUFBQUEsS0FGQUMsRUFBQUMsSUFBQSxHQUFBM0IsRUFBQUMsS0FHQXVCLEVBQUFJLEtBQ0F6QyxrREFDQXNDLDJCQUFBM0Msa0NBRUFNLEtBQUEsSUFDQSxHQUFBQyxFQUFBQyxHQUNBLE9BQUFELEVBQUFFLE9BRUEsTUFBQSxJQUFBQyxNQUFBLCtDQUdBSixLQUFBLEdBQUFHLEVBQUEsbUJBSUEsT0FBQXNDLFFBQUFDLElBQUFOLEtBSUEsU0FBQUQscUJBQUFkLEdBQ0EsT0FBQXRCLDhEQUNBc0IsYUFBQTNCLFVBRUFNLEtBQUEsSUFDQSxHQUFBQyxFQUFBQyxHQUNBLE9BQUFELEVBQUFFLE9BRUEsTUFBQSxJQUFBQyxNQUFBLCtDQUdBSixLQUFBLEdBQUFHLEVBQUF3QyxPQUdBLFNBQUFaLGNBQUFhLEdBQ0EsTUFBQUMsRUFBQSxJQUFBQyxLQUFBRixHQU9BLE9BQUFDLEVBQUFFLG1CQUFBLFFBTkEsQ0FDQUMsU0FBQSxpQkFDQUMsUUFBQSxFQUNBQyxLQUFBLFVBQ0FDLE9BQUEsWUF4SEE3RCxLQUFBOEQsaUJBQUEsV0FBQSxTQUFBQyxHQUNBLEtBQUFBLEVBQUFDLFVBQ0FELEVBQUFFLGlCQUNBakQsZ0JBQUFiLE1BQUErRCxVQUlBN0QsZ0JBQUF5RCxpQkFBQSxRQUFBLFNBQUFDLEdBQ0EsTUFBQUEsRUFBQUksT0FBQUMsVUFDQTFDLHNCQUFBcUMsRUFBQUksT0FBQXRDLGFBQ0FDLG1CQUFBaUMsRUFBQUksT0FBQUUsUUFBQXRDIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBmb3JtYCk7XHJcbmNvbnN0IGlucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKGBpbnB1dGApO1xyXG5jb25zdCBhcGlLZXkgPSBgRWhnNU5zbzRwTmUwa0dSSWZQV2A7XHJcbmNvbnN0IHN0cmVldENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5zdHJlZXRzYCk7XHJcbmNvbnN0IHRhYmxlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgdGJvZHlgKTtcclxuXHJcbmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihga2V5cHJlc3NgLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBidWlsZFN0cmVldExpc3QoaW5wdXQudmFsdWUpO1xyXG4gIH1cclxufSk7XHJcblxyXG5zdHJlZXRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICBpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT09IGBBYCkge1xyXG4gICAgYnVpbGRTdHJlZXROYW1lSGVhZGVyKGV2ZW50LnRhcmdldC50ZXh0Q29udGVudCk7XHJcbiAgICBidWlsZFNjaGVkdWFsVGFibGUoZXZlbnQudGFyZ2V0LmRhdGFzZXQuc3RyZWV0S2V5KTtcclxuICB9XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gZ2V0U3RyZWV0TmFtZShpbnB1dFN0TmFtZSkge1xyXG4gIHJldHVybiBmZXRjaChcclxuICAgIGBodHRwczovL2FwaS53aW5uaXBlZ3RyYW5zaXQuY29tL3YzL3N0cmVldHMuanNvbj9hcGkta2V5PSR7YXBpS2V5fSZuYW1lPSR7aW5wdXRTdE5hbWV9JnVzYWdlPWxvbmdgXHJcbiAgKVxyXG4gICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGVyZSBpcyBhIHByb2JsZW0gaW4gc3RyZWV0IG5hbWUgKDtUX19UOilgKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC50aGVuKChqc29uKSA9PiBqc29uLnN0cmVldHMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZFN0cmVldExpc3QoaW5wdXRTdE5hbWUpIHtcclxuICBsZXQgaHRtbCA9IGBgO1xyXG4gIHN0cmVldENvbnRhaW5lci5pbm5lckhUTUwgPSBgYDtcclxuXHJcbiAgZ2V0U3RyZWV0TmFtZShpbnB1dFN0TmFtZSkudGhlbigoc3RyZWV0QXJyYXkpID0+IHtcclxuICAgIGlmIChzdHJlZXRBcnJheS5sZW5ndGggIT09IDApIHtcclxuICAgICAgc3RyZWV0QXJyYXkuZm9yRWFjaCgoZWxlKSA9PiB7XHJcbiAgICAgICAgaHRtbCArPSBgPGEgaHJlZj1cIiNcIiBkYXRhLXN0cmVldC1rZXk9XCIke2VsZS5rZXl9XCI+JHtlbGUubmFtZX08L2E+YDtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBodG1sID0gYE5vIFN0cmVldHMgZm91bmRgO1xyXG4gICAgfVxyXG5cclxuICAgIHN0cmVldENvbnRhaW5lci5pbnNlcnRBZGphY2VudEhUTUwoYGJlZm9yZWVuZGAsIGh0bWwpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZFN0cmVldE5hbWVIZWFkZXIoc3RyZWV0TmFtZSkge1xyXG4gIGNvbnN0IHN0cmVldE5hbWVFbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjc3RyZWV0LW5hbWVgKTtcclxuICBzdHJlZXROYW1lRWxlLnRleHRDb250ZW50ID0gYGA7XHJcbiAgc3RyZWV0TmFtZUVsZS50ZXh0Q29udGVudCA9IGBEaXNwbGF5aW5nIHJlc3VsdHMgZm9yICR7c3RyZWV0TmFtZX1gO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZFNjaGVkdWFsVGFibGUoc3RyZWV0S2V5KSB7XHJcbiAgbGV0IGh0bWwgPSBgYDtcclxuICB0YWJsZUNvbnRhaW5lci5pbm5lckhUTUwgPSBgYDtcclxuXHJcbiAgZ2V0U2NoZWR1bGVBcnJheShzdHJlZXRLZXkpLnRoZW4oKHNjaGVkdWxlQXJyYXkpID0+IHtcclxuICAgIGZvciAobGV0IHNjaGVkdWxlIG9mIHNjaGVkdWxlQXJyYXkpIHtcclxuICAgICAgZm9yIChsZXQgcm91dGVTY2hlZHVsZSBvZiBzY2hlZHVsZVtgcm91dGUtc2NoZWR1bGVzYF0pIHtcclxuICAgICAgICBodG1sICs9IGAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPHRkPiR7c2NoZWR1bGUuc3RvcC5zdHJlZXQubmFtZX08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPHRkPiR7c2NoZWR1bGUuc3RvcFtgY3Jvc3Mtc3RyZWV0YF0ubmFtZX08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPHRkPiR7c2NoZWR1bGUuc3RvcC5kaXJlY3Rpb259PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke3JvdXRlU2NoZWR1bGUucm91dGUubnVtYmVyfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHt0aW1lRm9ybWF0dGVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVNjaGVkdWxlW2BzY2hlZHVsZWQtc3RvcHNgXVswXS50aW1lcy5kZXBhcnR1cmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAuZXN0aW1hdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICApfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90cj5gO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGFibGVDb250YWluZXIuaW5zZXJ0QWRqYWNlbnRIVE1MKGBiZWZvcmVlbmRgLCBodG1sKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U2NoZWR1bGVBcnJheShzdHJlZXRLZXkpIHtcclxuICByZXR1cm4gZ3N0U3RvcE5hbWVzSW5TdHJlZXQoc3RyZWV0S2V5KS50aGVuKChzdG9wQXJyYXkpID0+IHtcclxuICAgIGNvbnN0IGpzb25Qcm9taXNlID0gW107XHJcbiAgICBjb25zdCBzdG9wS2V5QXJyYXkgPSBzdG9wQXJyYXkubWFwKChlbGUpID0+IGVsZS5rZXkpO1xyXG5cclxuICAgIGZvciAobGV0IHN0b3BLZXkgb2Ygc3RvcEtleUFycmF5KSB7XHJcbiAgICAgIGpzb25Qcm9taXNlLnB1c2goXHJcbiAgICAgICAgZmV0Y2goXHJcbiAgICAgICAgICBgaHR0cHM6Ly9hcGkud2lubmlwZWd0cmFuc2l0LmNvbS92My9zdG9wcy8ke3N0b3BLZXl9L3NjaGVkdWxlLmpzb24/YXBpLWtleT0ke2FwaUtleX0mbWF4LXJlc3VsdHMtcGVyLXJvdXRlPTJgXHJcbiAgICAgICAgKVxyXG4gICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGVyZSBpcyBhIHByb2JsZW0gaW4gc3RvcCBuYW1lcyAoO1RfX1Q6KWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLnRoZW4oKGpzb24pID0+IGpzb25bYHN0b3Atc2NoZWR1bGVgXSlcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoanNvblByb21pc2UpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnc3RTdG9wTmFtZXNJblN0cmVldChzdHJlZXRLZXkpIHtcclxuICByZXR1cm4gZmV0Y2goXHJcbiAgICBgaHR0cHM6Ly9hcGkud2lubmlwZWd0cmFuc2l0LmNvbS92My9zdG9wcy5qc29uP3N0cmVldD0ke3N0cmVldEtleX0mYXBpLWtleT0ke2FwaUtleX1gXHJcbiAgKVxyXG4gICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGVyZSBpcyBhIHByb2JsZW0gaW4gc3RvcCBuYW1lcyAoO1RfX1Q6KWApO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGpzb24pID0+IGpzb24uc3RvcHMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0aW1lRm9ybWF0dGVyKHRpbWVTdHJpbmcpIHtcclxuICBjb25zdCB0aW1lID0gbmV3IERhdGUodGltZVN0cmluZyk7XHJcbiAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgIHRpbWVab25lOiBgQ2FuYWRhL0NlbnRyYWxgLFxyXG4gICAgaG91cjEyOiB0cnVlLFxyXG4gICAgaG91cjogYG51bWVyaWNgLFxyXG4gICAgbWludXRlOiBgbnVtZXJpY2AsXHJcbiAgfTtcclxuICByZXR1cm4gdGltZS50b0xvY2FsZVRpbWVTdHJpbmcoYGVuLVVTYCwgb3B0aW9ucyk7XHJcbn0iXX0=
